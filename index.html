<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Stock Material</title>

<style>
  body { font-family: Arial, sans-serif; text-align:center; padding:20px; }

  h1 { margin-bottom:20px; font-size:24px; }

  button {
    width:100%; padding:18px; font-size:18px;
    margin:10px 0; border:none; border-radius:8px;
    cursor:pointer;
  }

  .sin-stock { background:#d9534f; color:white; }
  .poco-stock { background:#f0ad4e; color:white; }

  input {
    width:100%; padding:12px; font-size:16px; text-align:center;
  }

  #msg { margin-top:15px; font-weight:bold; }

  /* Estilos del overlay de PIN */
  #pin-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.8);
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction: column;
    color:white;
    z-index: 1000;
  }

  #pin-overlay input {
    max-width:200px;
    margin-bottom:10px;
  }

  #pin-overlay button {
    width: auto;
  }
</style>

</head>
<body>

<!-- Overlay de PIN -->
<div id="pin-overlay">
  <h2>Ingrese el PIN para acceder</h2>
  <input type="password" id="pinInput" placeholder="PIN">
  <button onclick="verificarPIN()">Ingresar</button>
  <p id="pin-msg" style="color:red; margin-top:10px;"></p>
</div>

<!-- Contenido principal -->
<div id="contenido" style="display:none;">
  <h1 id="material-title">Material no identificado</h1>

  <button class="sin-stock" onclick="enviar('SIN STOCK', 0)">
    üö® SIN STOCK
  </button>

  <input type="number" id="cantidad" placeholder="Cantidad disponible">

  <button class="poco-stock" onclick="enviar('POCO STOCK', document.getElementById('cantidad').value)">
    ‚ö†Ô∏è POCO STOCK
  </button>

  <p id="msg"></p>
</div>

<script>
  // üîë PIN correcto
  const PIN_CORRECTO = "1812"; // Cambialo por el que quieras

  function verificarPIN() {
    const pinIngresado = document.getElementById("pinInput").value;
    const mensaje = document.getElementById("pin-msg");

    if(pinIngresado === PIN_CORRECTO){
      document.getElementById("pin-overlay").style.display = "none";
      document.getElementById("contenido").style.display = "block";
    } else {
      mensaje.textContent = "PIN incorrecto. Intenta nuevamente.";
      document.getElementById("pinInput").value = "";
    }
  }

  // üß† Leer material desde la URL
  const params = new URLSearchParams(window.location.search);
  const material = params.get("material") || "";
  document.getElementById("material-title").innerText = material || "Material no identificado";

  // üì© Ajust√° esta parte con tu Form
  const FORM_URL =
    "https://docs.google.com/forms/d/e/1FAIpQLSdvvyZy8DPPBssML6_LGJLXUpKL58icIbzOb4LDR2PQrYUBlg/formResponse";

  const ENTRY_MATERIAL = "entry.1737009670";
  const ENTRY_ESTADO   = "entry.1416497766";
  const ENTRY_CANTIDAD = "entry.794276494";

  function enviar(estado, cantidad) {
    if (!material) {
      alert("Material no identificado");
      return;
    }
    if (estado === "POCO STOCK" && !cantidad) {
      alert("Ingres√° la cantidad disponible");
      return;
    }

    const data = new FormData();
    data.append(ENTRY_MATERIAL, material);
    data.append(ENTRY_ESTADO, estado);
    data.append(ENTRY_CANTIDAD, cantidad);

    fetch(FORM_URL, { method:"POST", mode:"no-cors", body:data });

    document.getElementById("msg").innerText = "‚úîÔ∏è Aviso enviado";
  }
</script>

</body>
</html>

